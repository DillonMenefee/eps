<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>eps by straightdave</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">eps</h1>
        <p class="header">embedded PowerShell (templating tool for PowerShell)</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/straightdave/eps/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/straightdave/eps/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/straightdave/eps">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/straightdave">straightdave</a></p>


      </header>
      <section>
        <p><a href="https://ci.appveyor.com/project/dbroeglin/eps"><img src="https://ci.appveyor.com/api/projects/status/dkkgi7fg8fsubqph?svg=true" alt="Build status"></a></p>

<h1>
<a id="eps" class="anchor" href="#eps" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>EPS</h1>

<p>EPS ( <em>Embedded PowerShell</em> ), inspired by <a href="https://en.wikipedia.org/wiki/ERuby">ERB</a>, is a templating tool that embeds
PowerShell code into a text document. It is conceptually and syntactically similar to ERB 
for Ruby or <a href="http://twig.sensiolabs.org/">Twig</a> for PHP.</p>

<p>EPS can be used to generate any kind of text. The example below illustrates generating
plain text, but it could be used to generate HTML as in <a href="https://github.com/straightdave/ds">DS</a> or PowerShell code as 
in the <a href="https://github.com/dbroeglin/Forge.Module">Forge Module generator</a>.</p>

<p>EPS is available in the <a href="https://www.powershellgallery.com/packages/EPS">PowerShell Gallary</a>.
You can install the module with the following command:</p>

<div class="highlight highlight-source-powershell"><pre><span class="pl-c1">Install-Module</span> <span class="pl-k">-</span>Name EPS </pre></div>

<h2>
<a id="syntax" class="anchor" href="#syntax" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Syntax</h2>

<p>EPS allows PowerShell code to be embedded within a pair of <code>&lt;% ... %&gt;</code>, 
<code>&lt;%= ... %&gt;</code>, or <code>&lt;%# ... %&gt;</code> as well:</p>

<ul>
<li>Code in <code>&lt;% CODE %&gt;</code> blocks are executed but no value is inserted.

<ul>
<li>If started with <code>&lt;%-</code> : the preceding indentation is trimmed.</li>
<li>If terminated with <code>-%&gt;</code> : the following line break is trimmed. </li>
</ul>
</li>
<li>Code in <code>&lt;%= EXPRESSION %&gt;</code> blocks insert the value of <code>EXPRESSION</code>.<br>

<ul>
<li>If terminated with <code>-%&gt;</code> : the following line break is trimmed. </li>
</ul>
</li>
<li>Text in <code>&lt;%# ... %&gt;</code> blocks are treated as comments and are removed from the output.<br>

<ul>
<li>If terminated with <code>-%&gt;</code> : the following line break is trimmed.</li>
</ul>
</li>
<li>
<code>&lt;%%</code> and <code>%%&gt;</code> : are replaced respectively by <code>&lt;%</code> and <code>%&gt;</code> in the output. </li>
</ul>

<p>All blocks accept multi-line content as long as it is valid PowerShell.</p>

<h2>
<a id="command-line-usage" class="anchor" href="#command-line-usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Command Line Usage</h2>

<div class="highlight highlight-source-powershell"><pre><span class="pl-c1">Invoke-EpsTemplate</span> <span class="pl-e">[</span><span class="pl-k">-</span><span class="pl-e">Template</span> <span class="pl-k">&lt;</span><span class="pl-e">string</span><span class="pl-k">&gt;</span><span class="pl-e">]</span> <span class="pl-e">[</span><span class="pl-k">-</span><span class="pl-e">Binding</span> <span class="pl-k">&lt;</span><span class="pl-e">hashtable</span><span class="pl-k">&gt;</span><span class="pl-e">]</span> <span class="pl-e">[</span><span class="pl-k">-</span><span class="pl-e">Safe]</span>  <span class="pl-e">[</span><span class="pl-k">&lt;</span><span class="pl-e">CommonParameters</span><span class="pl-k">&gt;</span><span class="pl-e">]</span>

<span class="pl-c1">Invoke-EpsTemplate</span> <span class="pl-e">[</span><span class="pl-k">-</span><span class="pl-e">Path</span> <span class="pl-k">&lt;</span><span class="pl-e">string</span><span class="pl-k">&gt;</span><span class="pl-e">]</span> <span class="pl-e">[</span><span class="pl-k">-</span><span class="pl-e">Binding</span> <span class="pl-k">&lt;</span><span class="pl-e">hashtable</span><span class="pl-k">&gt;</span><span class="pl-e">]</span> <span class="pl-e">[</span><span class="pl-k">-</span><span class="pl-e">Safe]</span>  <span class="pl-e">[</span><span class="pl-k">&lt;</span><span class="pl-e">CommonParameters</span><span class="pl-k">&gt;</span><span class="pl-e">]</span></pre></div>

<ul>
<li>use <code>-Template</code> to render the template in the corresponding string. 
than a file</li>
<li>use <code>-Path</code> to render the template in the corresponding file.<br>
</li>
<li>
<code>-Safe</code> renders the template in <strong>isolated</strong> mode (in another thread/powershell 
instance) to avoid variable pollution (variable that are already in the current 
scope).<br>
</li>
<li>if <code>-Safe</code> is provided, you must bind your values using <code>-Binding</code> option 
with a <code>Hashtable</code> containing key/value pairs.<br>
</li>
</ul>

<h2>
<a id="example" class="anchor" href="#example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Example</h2>

<p>In a template file 'Test.eps':   </p>

<pre><code>Hi &lt;%= $name %&gt;

&lt;%# this is a comment -%&gt;
Please buy me the following items:
&lt;% 1..5 | %{ -%&gt;
  - &lt;%= $_ %&gt; pigs ...
&lt;% } -%&gt;

Dave is a &lt;% if($True) { %&gt;boy&lt;% } else { %&gt;girl&lt;% } %&gt;. 

Thanks,
Dave
&lt;%= (Get-Date -f yyyy-MM-dd) %&gt;
</code></pre>

<p>Then render it in on the command line:</p>

<div class="highlight highlight-source-powershell"><pre><span class="pl-c1">Import-Module</span> EPS

<span class="pl-k">$</span><span class="pl-smi">name</span> <span class="pl-k">=</span> <span class="pl-s">"ABC"</span>
<span class="pl-c1">Invoke-EpsTemplate</span> <span class="pl-k">-</span>Path Test.eps</pre></div>

<p>Here it is in non-safe mode (render template with values in current run space)
To use safe mode: using <code>Invoke-EpsTemplate -Path Test.eps -Safe</code> with binding values</p>

<p>It will produce:   </p>

<pre><code>Hi dave

Please buy me the following items:
  - 1 pigs ...
  - 2 pigs ...
  - 3 pigs ...
  - 4 pigs ...
  - 5 pigs ...

Dave is a boy.

Thanks,
Dave
2016-12-07
</code></pre>

<p>Or you can use safe mode with data bindings:</p>

<div class="highlight highlight-source-powershell"><pre><span class="pl-c1">Invoke-EpsTemplate</span> <span class="pl-k">-</span>Path Test.eps <span class="pl-k">-</span>Safe <span class="pl-k">-</span>binding @{ name <span class="pl-k">=</span> <span class="pl-s">"dave"</span> }</pre></div>

<p>which will generate the same output.</p>

<h2>
<a id="more-examples" class="anchor" href="#more-examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>More examples</h2>

<p>You can use multi-line statements in blocks:   </p>

<div class="highlight highlight-source-powershell"><pre><span class="pl-k">$</span><span class="pl-smi">template</span> <span class="pl-k">=</span> <span class="pl-s">@'</span>
<span class="pl-s">&lt;%=</span>
<span class="pl-s">  $name = "dave"</span>
<span class="pl-s"></span>
<span class="pl-s">  1..5 | %{</span>
<span class="pl-s">    "haha"</span>
<span class="pl-s">  }</span>
<span class="pl-s">%&gt;</span>
<span class="pl-s"></span>
<span class="pl-s">Hello, I'm &lt;%= $name %&gt;.</span>
<span class="pl-s">'@</span>

<span class="pl-c1">Invoke-EpsTemplate</span> <span class="pl-k">-</span>Template <span class="pl-k">$</span><span class="pl-smi">template</span></pre></div>

<p>will produce:</p>

<pre><code>haha haha haha haha haha

Hello, I'm dave.
</code></pre>

<h2>
<a id="contribution" class="anchor" href="#contribution" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contribution</h2>

<ul>
<li>Original version was written by <a href="https://github.com/straightdave">Dave Wu</a>.</li>
<li>Maintained now and extended by <a href="https://github.com/dbroeglin">Dominique Broeglin (@dbroeglin)</a>, thank you pal 谢谢！</li>
</ul>

<p>Help find more bugs! Or find more usage of this tool...
Author's email: <a href="mailto:eyaswoo@163.com">eyaswoo@163.com</a></p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
