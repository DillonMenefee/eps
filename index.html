<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>eps by straightdave</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>eps</h1>
        <p>embedded PowerShell (templating tool for PowerShell)</p>
        <p class="view"><a href="https://github.com/straightdave/eps">View the Project on GitHub <small>straightdave/eps</small></a></p>
        <ul>
          <li><a href="https://github.com/straightdave/eps/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/straightdave/eps/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/straightdave/eps">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="eps" class="anchor" href="#eps" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>EPS</h1>

<p>EPS ( <em>Embedded PowerShell</em> ), inspired by erb, is a templating tool that renders PowerShell code into text document, conceptually and syntactically similar to erb for Ruby or twig for PHP, etc.    </p>

<h3>
<a id="syntax" class="anchor" href="#syntax" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Syntax</h3>

<p>EPS allows PowerShell code to be embedded within a pair of <code>&lt;% ... %&gt;</code>, <code>&lt;%= ... %&gt;</code>, or <code>&lt;%# ... %&gt;</code> as well:</p>

<ul>
<li>Code in <code>&lt;% ... %&gt;</code> blocks are treated as statements or commands</li>
<li>Code in <code>&lt;%= ... %&gt;</code> blocks are treated as values or expressions<br>
</li>
<li>Text in <code>&lt;%# ... %&gt;</code> blocks are treated as comment which will be ignored in compilation<br>
</li>
</ul>

<blockquote>
<p>You can write multiple-line commands in a <code>&lt;% ... %&gt;</code> block.
You can also write code which produce text output in <code>&lt;% ... %&gt;</code> blocks, instead of using a <code>&lt;%= ... %&gt;</code> block.
But in this style the output text is not produced <strong>in-place</strong> for sure    </p>
</blockquote>

<h3>
<a id="commandline-usage" class="anchor" href="#commandline-usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Commandline usage</h3>

<pre><code>EPS-Render [[-template] $inline_template_str] | [-file $template_file] [-safe -binding $params_hash]
</code></pre>

<ul>
<li>use <strong>-template</strong> to provide template text via a commandline param rather than a file</li>
<li>if <strong>-file</strong> exists, it ignores <strong>-template</strong> param and render the template content in the file<br>
</li>
<li>
<strong>-safe</strong> renders template in <strong>isolated</strong> mode (in another thread/powershell space) to avoid variable pollution (variable name already in current context)<br>
</li>
<li>if <strong>-safe</strong> is provided, you should bind your values using <strong>-binding</strong> option with a hashtable containing k-v pairs<br>
</li>
</ul>

<h3>
<a id="example" class="anchor" href="#example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Example</h3>

<p>In a template file 'test.eps':   </p>

<pre><code>Hi &lt;%= $name %&gt;

&lt;%# this is a comment %&gt;
Please buy me the following items:
&lt;% 1..5 | %{ %&gt;
  - &lt;%= $_ %&gt; pigs ...
&lt;% } %&gt;

Dave is a &lt;% if($true) { %&gt; boy &lt;% } else { %&gt; girl &lt;% } %&gt;. 

Thanks,
Dave
&lt;%= (Get-Date -f yyyy-MM-dd) %&gt;
</code></pre>

<p>Then render it in commandline:</p>

<div class="highlight highlight-source-powershell"><pre><span class="pl-k">.</span> .\eps.ps1  <span class="pl-c"># load this tool into current PowerShell space</span>

<span class="pl-k">$</span><span class="pl-smi">name</span> <span class="pl-k">=</span> <span class="pl-s">"ABC"</span>
EPS<span class="pl-k">-</span>Render <span class="pl-k">-</span>file test.eps</pre></div>

<blockquote>
<p>Here it is in non-safe mode (render template with values in current run space)
To use safe mode: using <code>EPS-Render -file test.eps -safe</code> with binding values</p>
</blockquote>

<p>It will produce:   </p>

<pre><code>Hi ABC

Please buy me the following items:
  - 1 pigs ...
  - 2 pigs ...
  - 3 pigs ...
  - 4 pigs ...
  - 5 pigs ...

Dave is a boy.

Thanks,
Dave
2014-06-09
</code></pre>

<p>Or you can use safe mode with data bindings:</p>

<div class="highlight highlight-source-powershell"><pre>EPS<span class="pl-k">-</span>Render <span class="pl-k">-</span>file <span class="pl-k">$</span><span class="pl-smi">file_name</span> <span class="pl-k">-</span>safe <span class="pl-k">-</span>binding @{ name <span class="pl-k">=</span> <span class="pl-s">"dave"</span> }</pre></div>

<p>which will generate same output.</p>

<h3>
<a id="more-examples" class="anchor" href="#more-examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>More examples</h3>

<p>any statement result in a <code>&lt;% ... %&gt;</code> block will be placed at the template top (that's why you should use <code>&lt;%= ... %&gt;</code> instead):   </p>

<div class="highlight highlight-source-powershell"><pre><span class="pl-k">$</span><span class="pl-smi">template</span> <span class="pl-k">=</span> <span class="pl-s">@'</span>
<span class="pl-s">Hi, dave is a &lt;% if($true) { "boy" } else { "girl" } %&gt;</span>
<span class="pl-s">'@</span>

EPS<span class="pl-k">-</span>Render <span class="pl-k">-</span>template <span class="pl-k">$</span><span class="pl-smi">template</span></pre></div>

<p>will produce:   </p>

<pre><code>boy
Hi, dave is a 
</code></pre>

<p>for another instance, if template is</p>

<pre><code>Hi dave
Don't watch TV.

Your wife
&lt;% get-date -f yyyy-MM-dd %&gt;
</code></pre>

<p>It will produce:   </p>

<pre><code>2014-06-10
Hi dave
Don't watch TV.

Your wife
</code></pre>

<blockquote>
<p>You should use <code>&lt;%= ... %&gt;</code>. <code>&lt;%= $(get-date -f yyyy-MM-dd) %&gt;</code> produces the date string at the same location.</p>
</blockquote>

<p>You can use multi-line statements in <code>&lt;% ... %&gt;</code> block:   </p>

<div class="highlight highlight-source-powershell"><pre><span class="pl-k">$</span><span class="pl-smi">template</span> <span class="pl-k">=</span> <span class="pl-s">@'</span>
<span class="pl-s"></span>
<span class="pl-s">&lt;%</span>
<span class="pl-s">  $name = "dave"</span>
<span class="pl-s"></span>
<span class="pl-s">  1..5 | %{</span>
<span class="pl-s">    "haha"</span>
<span class="pl-s">  }</span>
<span class="pl-s">%&gt;</span>
<span class="pl-s"></span>
<span class="pl-s">Hello, I'm &lt;%= $name %&gt;.</span>
<span class="pl-s">'@</span>

EPS<span class="pl-k">-</span>Render <span class="pl-k">-</span>template <span class="pl-k">$</span><span class="pl-smi">template</span></pre></div>

<p>it will produce:   </p>

<pre><code>haha
haha
haha
haha
haha

Hello, I'm dave.
</code></pre>

<blockquote>
<p>Remaider: the output of statements in <code>&lt;% ... %&gt;</code> block will be put at top   </p>
</blockquote>

<h2>
<a id="contribute" class="anchor" href="#contribute" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contribute</h2>

<p>Help find more bugs! Or find more usage of this tool ...
Author's email: <a href="mailto:eyaswoo@163.com">eyaswoo@163.com</a></p>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/straightdave">straightdave</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
